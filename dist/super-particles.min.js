/* -----------------------------------------------
/* Author: Artur Zoremba (Skor_X) - skorx.ga
/* MIT license: http://opensource.org/licenses/MIT
/* GitHub: https://github.com/SkorX/Super-Particles
/* Page: https://skorx.github.io/Super-Particles
/* v0.2.0
/* ----------------------------------------------- */

// --- OPTIONS EXPLANATION (with default values) (do not uncomment this code, preview only) ---
// SuperParticles options:
// {
//     particles: {
//         count:                       0,              (number)
//         properties: {
//             shape: {
//                 type:                "none",         (string, ("none" || "circle" || "square"))
//                 size:                25,             (number)
//                 color:               "#FFFFFF",      (string, [#colorString])
//                 stroke: {
//                     width:           0,              (number)
//                     color:           "#000000",      (string, [#colorString])
//                 }
//             }
//             image: {
//                 data:                undefined,      (undefined || HTMLImageElement)
//                 size:                15,             (number)
//                 opacity:             1,              (number, (0 < val <= 1))
//             }
//             motion: {
//                 speed:               8,              (number, (0 <= val))
//                 min_speed:           undefined,      (number, val < speed)
//                 bouncing:            true,           (boolean)
//                 slowDownOnCollision: false,          (boolean)
//                 vx:                  undefined,      (undefined || number, number: (0 < val <= 1))
//                 vy:                  undefined,      (undefined || number, number: (0 < val <= 1))
//                 vx_min:              undefined,      (undefined || number, number: (0 < val <= 1))
//                 vy_min:              undefined,      (undefined || number, number: (0 < val <= 1))
//             }
//             opacity: {
//                 value:               1,              (number, (0 < val <= 1))
//                 alternation: {
//                     enabled:         true,           (boolean)
//                     speed:           1,              (number)
//                     min_value:       0,              (number)
//                 }
//             }
//         }
//     }
//     linking: {
//         enabled:                     true,           (boolean)
//         max_distance:                150,            (numbar)
//         color:                       "#FFFFFF",      (string, [#colorString])
//         width:                       1.5,            (number)
//         opacity:                     0.6,            (number, (0 < val <= 1))
//     }
//     attraction: {
//         enabled:                     true            (boolean)
//         rotateX:                     500,            (numbar)
//         rotateY:                     500,            (numbar)
//     }
// }

// Single particle options:
// {
//     x:                      undefined,          (number)
//     y:                      undefined,          (number)
//
//     vx:                     undefined,          (number)
//     vy:                     undefined,          (number)
//
//     gravityForce:           0,                  (number)
//
//     apperance: {
//         shapeType:          undefined,          (string, ("none" | "circle" | "square"))
//         shapeSize:          0,                  (number, (0 <= val))
//         shapeColor:         undefined           (string, [#colorString])
//
//         strokeWidth:        0,                  (number, (0 <= val))
//         strokeColor:        undefined,          (string, [#colorString])
//
//         image:              undefined,          (undefined | HTMLImageElement)
//         imageSize:          0,                  (number, (0 <= val))
//         imageOpacity:       1,                  (number, (0 <= val <= 1))
//
//         opacity:            1,                  (number, (0 < val <= 1))
//     }
//     behavior: {
//         bounce:             true,               (boolean)
//         collisionSlowdown:  false,              (boolean)
//     }
// }

var Images={getCanvasForImage:function(e){if(!(e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof HTMLVideoElement))throw new Error("Can't convert image, because it is in wrong format.");var t=document.createElement("canvas"),a=t.getContext("2d");if(e instanceof HTMLCanvasElement)t.width=e.width,t.height=e.height;else if(e instanceof HTMLImageElement){if(!1===e.complete||void 0===e.naturalWidth||0===e.naturalWidth)throw new Error("Passed image is broken.");t.width=e.naturalWidth,t.height=e.naturalHeight}else if(e instanceof HTMLVideoElement){if(void 0===e.videoWidth||0===e.videoWidth)throw new Error("Passed video is broken.");t.width=e.videoWidth,t.height=e.videoHeight}a.drawImage(e,0,0);try{a.getImageData(0,0,1,1)}catch(e){if("SecurityError"===e.name)throw new TaintedImageError("Loaded image causes security errors. Load image from the same domain or allow for cross-origin data.")}return t},convertImage:function(e,t,a){if(!(e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof HTMLVideoElement))throw new Error("Can't convert image, because it is in wrong format.");if(t!==HTMLCanvasElement&&t!==HTMLImageElement&&t!==Image)throw new Error("Can't convert image, because targetType is incorrect.");var n=Images.getCanvasForImage(e);if(t===HTMLCanvasElement)setTimeout(function(){a.call(this,n)}.bind(Images));else if(t===HTMLImageElement||t===Image){var r=new Image(n.width,n.height);r.onload=function(){a.call(Images,r)}.bind(this),r.onerror=function(){throw new Error("While converting an image to HTMLImageElement, error has occured.")},r.src=n.toDataURL()}return Images},getScaledDownImage:function(e,t,a){if(void 0===e||!(e instanceof HTMLCanvasElement))return!1;var n=Images.getCanvasForImage(e);if(e.width>t||e.height>a){var r=e.width/e.height,i=e.width,o=e.height;t<i&&(o=(i=t)*(1/r)),a<o&&(i=(o=a)*r),n.width=i,n.height=o,n.getContext("2d").drawImage(e,0,0,i,o)}return n},getScaledImage:function(e,t,a){if(void 0===e||!(e instanceof HTMLCanvasElement))return!1;if(!isFinite(t))return Images.getCanvasForImage(e);var n=document.createElement("canvas");if(n.width=t,isFinite(a))n.height=a;else{var r=e.height/e.width;n.height=t*r}return n.getContext("2d").drawImage(e,0,0,n.width,n.height),n}};function TaintedImageError(e,t){Error.call(this,e),this.name="TaintedImageError",this.innerError=t}TaintedImageError.prototype=Object.create(Error.prototype),TaintedImageError.prototype.toString=function(){return this.name+': "'+this.message+'"'},Math.rand=function(e,t){return Math.random()*(t-e)+e},Math.randInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},Math.sqr=function(e){return e*e},Math.cub=function(e){return e*e*e};
var SuperParticle=function(e,i){"use strict";if(!(this instanceof SuperParticle))throw new Error("SuperParticle have to be executed as a class. Use new keyword.");if("object"!=typeof i)throw new Error("Options are not valid object element.");if(this._position={x:void 0,y:void 0},this._movement={vx:void 0,vy:void 0,initialSpeedSqr:void 0},this._gravity={force:0},this._apperance={shape:{type:void 0,size:0,color:void 0,stroke:{width:0,color:void 0}},image:{sourceData:void 0,data:void 0,size:0,opacity:1},opacity:{value:1,alternation:{speed:0,min_value:0}},_size:0},this._behavior={bounce:!0,slowdownOnCollision:!1},this.tag=void 0,"string"!=typeof e)throw new Error("Tag have to be a valid string.");return this.tag=e,this._loadOptions(i),this};SuperParticle.prototype.getState=function(){return JSON.parse(JSON.stringify({position:this._position,movement:this._movement,gravity:this._gravity,apperance:{shape:this._apperance.shape,image:{data:this._apperance.image.sourceData.toDataURL(),size:this._apperance.image.size,opacity:this._apperance.image.opacity},opacity:this._apperance.opacity},size:this._apperance._size,behavior:this._behavior,tag:this.tag}))},SuperParticle.prototype.size=function(){return this._apperance._size},SuperParticle.prototype.setSpeed=function(e){if(!isFinite(e))throw new Error("Speed have to be finite number.");var i=Math.sqrt(Math.sqr(this._movement.vx)+Math.sqr(this._movement.vy))/e;return this._movement.vx/=i,this._movement.vy/=i,this._movement.initialSpeedSqr=Math.sqr(e),this},SuperParticle.prototype.resetSpeed=function(){var e=Math.sqr(this._movement.vx)+Math.sqr(this._movement.vy),i=Math.sqrt(e/this._movement.initialSpeedSqr);return this._movement.vx/=i,this._movement.vy/=i,this},SuperParticle.prototype.applyForce=function(e,i,t){return t="boolean"==typeof t&&t,isFinite(e)&&isFinite(i)&&(this._movement.vx+=e,this._movement.vy+=i,t&&(this._movement.initialSpeedSqr=Math.sqr(this._movement.vx)+Math.sqr(this._movement.vy))),this},SuperParticle.prototype.attractTo=function(e){if(0==this._gravity.force||0==e._gravity.force)return this;if(this._position.x===e._position.x&&this._position.y===e._position.y)return this;var i=Math.sqr(this._position.x-e._position.x)+Math.sqr(this._position.y-e._position.y);if(i>Math.SQRT2&&isFinite(i)){var t=Math.abs(this._gravity.force*e._gravity.force)/i;if(t<=0&&(t=.01),t<.01||10<t)return this;var a=e._position.x-this._position.x,p=e._position.y-this._position.y,s=Math.sqrt(i);this.applyForce(a/s*(t/this._gravity.force),p/s*(t/this._gravity.force)),e.applyForce(-a/s*(t/e._gravity.force),-p/s*(t/e._gravity.force))}return this},SuperParticle.prototype.update=function(){return this._position.x+=this._movement.vx,this._position.y+=this._movement.vy,this},SuperParticle.prototype.checkPosition=function(e,i){if(!isFinite(e)||!isFinite(i))return this;var t=!1,a=this.size()/2;return this._behavior.bounce?(this._position.x+a>=e&&0<this._movement.vx?(this._movement.vx=-this._movement.vx,t=!0):this._position.x-a<=0&&this._movement.vx<0&&(this._movement.vx=-this._movement.vx,t=!0),this._position.y+a>=i&&0<this._movement.vy?(this._movement.vy=-this._movement.vy,t=!0):this._position.y-a<=0&&this._movement.vy<0&&(this._movement.vy=-this._movement.vy,t=!0)):(this._position.x-a>=e?(this._position.x=-a,t=!0):this._position.x+a<=0&&(this._position.x=e+a,t=!0),this._position.y-a>=i?(this._position.y=-a,t=!0):this._position.y+a<=0&&(this._position.y=i+a,t=!0)),t&&this._behavior.slowdownOnCollision&&this.resetSpeed(),this},SuperParticle.prototype.draw=function(e,i){if(void 0!==this._apperance.shape.type&&this._apperance.shape.size&&this._apperance.shape.color){if(e.beginPath(),"circle"===this._apperance.shape.type)e.arc(this._position.x,this._position.y,this._apperance.shape.size/2,0,2*Math.PI);else{var t=this._apperance.shape.size/2;e.rect(this._position.x-t,this._position.y-t,this._apperance.shape.size,this._apperance.shape.size)}e.globalAlpha=this._apperance.opacity,e.fillStyle=this._apperance.shape.color,e.fill(),this._apperance.shape.stroke.width&&this._apperance.shape.stroke.color&&(e.lineWidth=this._apperance.shape.stroke.width,e.strokeStyle=this._apperance.shape.stroke.color,e.stroke())}if(void 0!==this._apperance.image.data&&this._apperance.image.size&&this._apperance.image.opacity){var a=this._apperance.image.data.height/this._apperance.image.data.width,p=this._apperance.image.size*a,s=this._apperance.image.size/2,o=p/2;e.beginPath(),e.globalAlpha=this._apperance.image.opacity,e.imageSmoothingEnabled="boolean"==typeof i&&i,e.drawImage(this._apperance.image.data,this._position.x-s,this._position.y-o,this._apperance.image.size,p)}return this},SuperParticle.prototype._loadOptions=function(e){if("object"!=typeof e)return!1;if("x"in e&&isFinite(e.x)&&(this._position.x=e.x),"y"in e&&isFinite(e.y)&&(this._position.y=e.y),"vx"in e&&isFinite(e.vx)&&(this._movement.vx=e.vx,this._movement.initialSpeedSqr=Math.sqr(this._movement.vx)+Math.sqr(this._movement.vy)),"vy"in e&&isFinite(e.vy)&&(this._movement.vy=e.vy,this._movement.initialSpeedSqr=Math.sqr(this._movement.vx)+Math.sqr(this._movement.vy)),"gravityForce"in e&&isFinite(e.gravityForce)&&(this._gravity.force=e.gravityForce),"object"==typeof e.apperance){if("shapeType"in e.apperance&&("circle"===e.apperance.shapeType||"square"===e.apperance.shapeType?this._apperance.shape.type=e.apperance.shapeType:"none"===e.apperance.shapeType&&(this._apperance.shape.type=void 0)),"shapeSize"in e.apperance&&isFinite(e.apperance.shapeSize)&&0<=e.apperance.shapeSize&&(this._apperance.shape.size=e.apperance.shapeSize,this._recalculateSize()),"shapeColor"in e.apperance&&"string"==typeof e.apperance.shapeColor&&(this._apperance.shape.color=e.apperance.shapeColor),"strokeWidth"in e.apperance&&isFinite(e.apperance.strokeWidth)&&0<=e.apperance.strokeWidth&&(this._apperance.shape.stroke.width=e.apperance.strokeWidth,this._recalculateSize()),"strokeColor"in e.apperance&&"string"==typeof e.apperance.strokeColor&&(this._apperance.shape.stroke.color=e.apperance.strokeColor),"image"in e.apperance&&e.apperance.image instanceof HTMLImageElement)try{var i=Images.getCanvasForImage(e.apperance.image);this._apperance.image.sourceData=i,this._apperance.image.size&&(this._apperance.image.data=Images.getScaledImage(i,this._apperance.image.size))}catch(e){console.log("Particle image is unusable. Image won't be loaded.")}"imageSize"in e.apperance&&isFinite(e.apperance.imageSize)&&0<=e.apperance.imageSize&&(this._apperance.image.size=e.apperance.imageSize,this._recalculateSize(),this._apperance.image.sourceData&&(this._apperance.image.data=Images.getScaledImage(this._apperance.image.sourceData,this._apperance.image.size))),"imageOpacity"in e.apperance&&isFinite(e.apperance.imageOpacity)&&0<=e.apperance.imageOpacity&&e.apperance.imageOpacity<=1&&(this._apperance.image.opacity=e.apperance.imageOpacity),"opacity"in e.apperance&&isFinite(e.apperance.opacity)&&0<e.apperance.opacity&&e.apperance.opacity<=1&&(this._apperance.opacity.value=e.apperance.opacity)}return"object"==typeof e.behavior&&("bounce"in e.behavior&&"boolean"==typeof e.behavior.bounce&&(this._behavior.bounce=e.behavior.bounce),"collisionSlowdown"in e.behavior&&"boolean"==typeof e.behavior.collisionSlowdown&&(this._behavior.slowdownOnCollision=e.behavior.collisionSlowdown)),!0},SuperParticle.prototype._recalculateSize=function(){var e=null!=this._apperance.shape.type&&this._apperance.shape.color?this._apperance.shape.size+this._apperance.shape.stroke.width:0,i=null!=this._apperance.image.data&&this._apperance.image.opacity?this._apperance.image.size:0;return this._apperance._size=Math.max(e,i)},SuperParticle.prototype._calculateDistance=function(e,i){return Math.abs(Math.sqrt(Math.sqr(e._position.x-i._position.x)+Math.sqr(e._position.y-i._position.y)))};
var SuperParticles=function(i,t){"use strict";if(!(this instanceof SuperParticles))throw new Error("SuperParticles have to be executed as a class. Use new keyword.");if(!(i instanceof HTMLCanvasElement))throw new Error("Passed canvas element have to be HTMLCanvasElement.");if("object"!=typeof t)throw new Error("Options are not valid object element.");return this._initialized=!1,this._settings={particles:{count:0,properties:{shape:{type:"none",size:25,color:"#FFFFFF",stroke:{width:0,color:"#000000"}},image:{data:void 0,size:15,opacity:1},motion:{speed:8,min_speed:void 0,bouncing:!0,slowDownOnCollision:!1,direction:void 0,vx:void 0,vy:void 0,vx_min:void 0,vy_min:void 0},opacity:{value:1,alternation:{enabled:!1,speed:1,min_value:0}}},smoothImages:!1},linking:{enabled:!0,max_distance:150,color:"#FFFFFF",width:1.5,opacity:.6},attraction:{enabled:!0,force:500},background:{color:void 0,image:void 0,_imagePosition:{x:0,y:0,width:0,height:0}}},this._canvas={element:void 0,ctx:void 0,width:0,height:0,drawing:{stop:!0,limitTo30FPS:!1,isResizeEventRunning:!1,lastWindowResizeTime:Date.now()}},this._particlesCount=0,this._particles=[],this._callbacks={initialized:[],windowResized:[],diagnostics:[],_initialized:void 0,_windowResized:void 0,_diagnostics:void 0},this._keyboard={queue:[]},this._diagData={fps:0,frame:0,count:0,startTime:Date.now(),_times:[]},this.onInitialized=void 0,this.onWindowResized=void 0,this.onDiagnostics=void 0,this._resizeHandler=function(){this._canvas.drawing.lastWindowResizeTime=Date.now(),this._canvas.drawing.isResizeEventRunning||(this._canvas.drawing.isResizeEventRunning=!0,setTimeout(this._resizeEventProcess,50))}.bind(this),this._resizeEventProcess=function(){if(this._canvas.drawing.isResizeEventRunning&&this._canvas.drawing.lastWindowResizeTime+50>Date.now())setTimeout(this._resizeEventProcess,50);else{if(this._drawing_ClearCanvas(),this._canvas.element.style.boxSizing="content-box",this._canvas.element.style.padding="0",this._canvas.width=this._canvas.element.width=this._canvas.element.offsetWidth,this._canvas.height=this._canvas.element.height=this._canvas.element.offsetHeight,this._settings.background.image){var i=this._canvas.width/this._canvas.height,t=this._settings.background.image.naturalWidth/this._settings.background.image.naturalHeight;if(i==t)this._settings.background._imagePosition={x:0,y:0,width:this._canvas.width,height:this._canvas.height};else if(t<i){var e=Math.round(this._canvas.width/2),s=this._canvas.height/this._settings.background.image.naturalHeight,a=Math.floor(this._settings.background.image.width*s/2);this._settings.background._imagePosition={x:0,y:e-a,width:Math.floor(this._settings.background.image.width*s),height:this._canvas.height}}else{var n=Math.round(this._canvas.height/2);s=this._canvas.width/this._settings.background.image.width,a=Math.floor(this._settings.background.image.height*s/2);this._settings.background._imagePosition={x:n-a,y:0,width:this._canvas.width,height:Math.floor(this._settings.background.image.height*s)}}}for(var r=0;r<this._particles.length;r++)this._particles[r].checkPosition(this._canvas.width,this._canvas.height);this._canvas.element.style.visibility="visible",this._canvas.drawing.isResizeEventRunning=!1,this._handleEvent("windowResized")}}.bind(this),this._keyDownHandler=function(i){this._kc(i)}.bind(this),this._kc=function(i){return this._keyboard.queue.push(i.keyCode),10<this._keyboard.queue.length&&this._keyboard.queue.shift(),"38,38,40,40,37,39,37,39,66,65"===this._keyboard.queue.toString()}.bind(this),this._canvas.element=i,this._canvas.ctx=i.getContext("2d"),this._canvas.width=this._canvas.element.width=this._canvas.element.offsetWidth,this._canvas.height=this._canvas.element.height=this._canvas.element.offsetHeight,this._loadOptions(t),window.addEventListener("keydown",this._keyDownHandler),window.addEventListener("resize",this._resizeHandler),this._resizeHandler(),this._initialized=!0,this.startDrawing(),this};SuperParticles.version={major:0,minor:2,revision:0,beta:!0},SuperParticles.prototype.addParticle=function(i,t){if(!(i instanceof SuperParticle))throw new Error("Particle have to be a SuperParticle instance.");return"number"==typeof t?this._particles.splice(t,0,i):this._particles.push(i),this._particlesCount=this._particles.length,this},SuperParticles.prototype.removeParticle=function(i){if(!0===i)return this._particles.pop(),this._particlesCount=this._particles.length,this;if(i instanceof SuperParticle){var t=this._particles.indexOf(i);return-1!==t&&this._particles.splice(t,1),this._particlesCount=this._particles.length,this}throw new Error("Particle have to be a SuperParticle instance.")},SuperParticles.prototype.addEventListener=function(i,t){return"string"!=typeof i||"function"!=typeof t||!i.startsWith("_")&&i in this._callbacks&&this._callbacks[i].push(t),this},SuperParticles.prototype.removeEventListener=function(i,t){if("string"!=typeof i||"function"!=typeof t)return this;if(!i.startsWith("_")&&i in this._callbacks){var e=this._callbacks[i].indexOf(t);-1!==e&&this._callbacks[i].splice(e,1)}return this},SuperParticles.prototype.startDrawing=function(){return this._canvas.drawing.stop&&this._initialized&&(this._canvas.drawing.stop=!1,this._diagData.startTime=Date.now(),this._requestFrame(this._process)),this},SuperParticles.prototype.stopDrawing=function(){return this._canvas.drawing.stop=!0,this},SuperParticles.prototype.getScreenshotData=function(i,t,e){if(!this._initialized)return this._execCallback(i,[!1]),that;var s=this._canvas.element.toDataURL(t,e);return this._execCallback(i,[s]),that},SuperParticles.prototype.getScreenshot=function(t){if("function"!=typeof t)throw new Error("Callback parameter is not a function.");this.getScreenshotData(function(i){if(!1===i)return this._execCallback(t,[!1]),this});var i=document.createElement("img");return i.onload=function(){this._execCallback(t,[i])}.bind(this),i.src=imageData,this},SuperParticles.prototype._loadOptions=function(i){if("object"!=typeof i)return!1;var t=this._engineState();if("object"==typeof i.particles){if("count"in i.particles&&isFinite(i.particles.count)&&0<=i.particles.count&&(this._settings.particles.count=i.particles.count),"shapeType"in i.particles&&"string"==typeof i.particles.shapeType)switch(i.particles.shapeType){case"circle":this._settings.particles.properties.shape.type="circle";break;case"square":this._settings.particles.properties.shape.type="square";break;case"none":default:this._settings.particles.properties.shape.type=void 0}if("shapeSize"in i.particles&&isFinite(i.particles.shapeSize)&&0<=i.particles.shapeSize&&(this._settings.particles.properties.shape.size=i.particles.shapeSize),"shapeColor"in i.particles&&"string"==typeof i.particles.shapeColor&&(this._settings.particles.properties.shape.color=i.particles.shapeColor),"strokeWidth"in i.particles&&isFinite(i.particles.strokeWidth)&&0<=i.particles.strokeWidth&&(this._settings.particles.properties.shape.stroke.width=i.particles.strokeWidth),"strokeColor"in i.particles&&"string"==typeof i.particles.strokeColor&&(this._settings.particles.properties.shape.stroke.color=i.particles.strokeColor),"image"in i.particles)if(i.particles.image instanceof HTMLImageElement)try{var e=Images.getCanvasForImage(i.particles.image);this._settings.particles.properties.image.data=e}catch(i){console.log("Particle image is unusable. Image won't be stored.")}else i.particles.image||(this._settings.particles.properties.image.data=void 0);if("imageSize"in i.particles&&isFinite(i.particles.imageSize)&&0<=i.particles.imageSize&&(this._settings.particles.properties.image.size=i.particles.imageSize),"imageOpacity"in i.particles&&isFinite(i.particles.imageOpacity)&&0<=i.particles.imageOpacity&&i.particles.imageOpacity<=1&&(this._settings.particles.properties.image.opacity=i.particles.imageOpacity),"speed"in i.particles&&isFinite(i.particles.speed)&&0<=i.particles.speed&&(this._settings.particles.properties.motion.speed=i.particles.speed,this._settings.particles.properties.motion.min_speed>=this._settings.particles.properties.motion.speed&&(this._settings.particles.properties.motion.min_speed=void 0)),"min_speed"in i.particles&&isFinite(i.particles.min_speed)&&0<=i.particles.min_speed&&i.particles.min_speed<this._settings.particles.properties.motion.speed&&(this._settings.particles.properties.motion.min_speed=i.particles.min_speed),"bouncing"in i.particles&&"boolean"==typeof i.particles.bouncing&&(this._settings.particles.properties.motion.bouncing=i.particles.bouncing),"collisionSlowdown"in i.particles&&"boolean"==typeof i.particles.collisionSlowdown&&(this._settings.particles.properties.motion.slowDownOnCollision=i.particles.collisionSlowdown),"direction"in i.particles)if("string"==typeof i.particles.direction)switch(i.particles.direction){case"top":case"bottom":case"left":case"right":case"topleft":case"topright":case"bottomleft":case"bottomright":this._settings.particles.properties.motion.direction=i.particles.direction;break;case"none":this._settings.particles.properties.motion.direction=void 0}else void 0===i.particles.direction&&(this._settings.particles.properties.motion.direction=void 0);"vx"in i.particles&&isFinite(i.particles.vx)&&-1<=i.particles.vx&&i.particles.vx<=1&&(this._settings.particles.properties.motion.vx=i.particles.vx,this._settings.particles.properties.motion.vx_min>=i.particles.vx&&(this._settings.particles.properties.motion.vx_min=void 0)),"vy"in i.particles&&isFinite(i.particles.vy)&&-1<=i.particles.vy&&i.particles.vy<=1&&(this._settings.particles.properties.motion.vy=i.particles.vy,this._settings.particles.properties.motion.vy_min>=i.particles.vy&&(this._settings.particles.properties.motion.vy_min=void 0)),"vx_min"in i.particles&&isFinite(i.particles.vx_min)&&-1<=i.particles.vx_min&&i.particles.vx_min<this._settings.particles.properties.motion.vx&&(this._settings.particles.properties.motion.vx_min=i.particles.vx_min),"vy_min"in i.particles&&isFinite(i.particles.vy_min)&&-1<=i.particles.vy_min&&i.particles.vy_min<this._settings.particles.properties.motion.vx&&(this._settings.particles.properties.motion.vy_min=i.particles.vy_min),"opacity"in i.particles&&isFinite(i.particles.opacity)&&0<i.particles.opacity&&i.particles.opacity<=1&&(this._settings.particles.properties.opacity.value=i.particles.opacity)}if("object"==typeof i.linking&&("enabled"in i.linking&&"boolean"==typeof i.linking.enabled&&(this._settings.linking.enabled=i.linking.enabled),"max_distance"in i.linking&&isFinite(i.linking.max_distance)&&0<i.linking.max_distance&&(this._settings.linking.max_distance=i.linking.max_distance),"color"in i.linking&&"string"==typeof i.linking.color&&(this._settings.linking.color=i.linking.color),"width"in i.linking&&isFinite(i.linking.width)&&0<i.linking.width&&(this._settings.linking.width=i.linking.width),"opacity"in i.linking&&isFinite(i.linking.opacity)&&0<i.linking.opacity&&i.linking.opacity<=1&&(this._settings.linking.opacity=i.linking.opacity)),"object"==typeof i.attraction&&("enabled"in i.attraction&&"boolean"==typeof i.attraction.enabled&&(this._settings.attraction.enabled=i.attraction.enabled),"force"in i.attraction&&isFinite(i.attraction.force)&&(this._settings.attraction.force=i.attraction.force)),"smoothImages"in i&&"boolean"==typeof i.smoothImages&&(this._settings.particles.smoothImages=i.smoothImages),"object"==typeof i.background&&("color"in i.background&&("string"==typeof i.background.color?this._settings.background.color=i.background.color:i.background.color||(this._settings.background.color=void 0)),"image"in i.background))if(i.background.image instanceof HTMLImageElement)try{e=Images.getCanvasForImage(i.background.image);this._settings.background.image=e}catch(i){console.log("Background image is unusable. Image won't be stored.")}else i.background.image||(this._settings.background.image=void 0);return"limit30FPS"in i&&"boolean"==typeof i.limit30FPS&&(this._canvas.drawing.limitTo30FPS=i.limit30FPS),this._updateParticles(t,this._engineState()),!0},SuperParticles.prototype._updateParticles=function(i,t){var e=t.particles.count-i.particles.count,s=this._getEngineGeneratedParticles();if(0<e)for(;e--;)this.addParticle(this._generateParticle());else if(e<0){e=Math.abs(e);for(var a=s.splice(s.length-e,e),n=0;n<a.length;n++)this.removeParticle(a[n])}},SuperParticles.prototype._getEngineGeneratedParticles=function(){for(var i=[],t=this._particles.length,e=0;e<t;e++)void 0===this._particles[e].tag&&i.push(this._particles[e]);return i},SuperParticles.prototype._generateParticle=function(){},SuperParticles.prototype._engineState=function(){var i,t;return this._settings.particles.properties.image.data&&(i=this._settings.particles.properties.image.data.toDataURL()),this._settings.background.image&&(t=this._settings.background.image.toDataURL()),JSON.parse(JSON.stringify({particles:{count:this._settings.particles.count,shape:this._settings.particles.properties.shape,image:{data:i,size:this._settings.particles.properties.image.size,opacity:this._settings.particles.properties.image.opacity},motion:this._settings.particles.properties.motion,opacity:this._settings.particles.properties.opacity,smoothImages:this._settings.particles.smoothImages},linking:this._settings.linking,attraction:this._settings.attraction,background:{color:this._settings.background.color,image:t},drawing:{stop:this._canvas.drawing.stop,limitTo30FPS:this._canvas.drawing.limitTo30FPS},frame:this._diagData.frame}))},SuperParticles.prototype._particlesState=function(){for(var i=[],t=0;t<this._particles.length;t++)i.push(this._particles[t].getState())},SuperParticles.prototype._handleEvent=function(t,e,i,s){if("string"!=typeof t)throw new Error("_handleEvent - Event name have to be a string value.");if(s="boolean"==typeof s&&s,!(i="boolean"==typeof i&&i)){var a="_"+t;a in this._callbacks&&"function"==typeof this._callbacks[a]&&this._callbacks[a].apply(this,e)}if(!s){var n="on"+t.charAt(0).toUpperCase()+t.slice(1);if(t in this._callbacks)for(var r=0;r<this._callbacks[t].length;r++)setTimeout(function(i){this._callbacks[t][i].apply(this,e)}.bind(this),void 0,r);n in this&&"function"==typeof this[n]&&setTimeout(function(){this[n].apply(this,e)}.bind(this))}},SuperParticles.prototype._execCallback=function(i,t){if("function"!=typeof i)throw new Error("Callback parameter is not a function.");try{setTimeout(function(){i.apply(this,t)}.bind(this))}catch(i){console.exception("An error was thrown during callback: "+i.message||i)}},SuperParticles.prototype._requestFrame=function(i){if(window.requestAnimationFrame)window.requestAnimationFrame(i.bind(this));else if(window.mozRequestAnimationFrame)window.mozRequestAnimationFrame(i.bind(this));else if(window.webkitRequestAnimationFrame)window.webkitRequestAnimationFrame(i.bind(this));else if(window.oRequestAnimationFrame)window.oRequestAnimationFrame(i.bind(this));else{if(!window.msRequestAnimationFrame)throw new Error("Can't redraw canvas, because browser do not support any requestAnimationFrame method.");window.msRequestAnimationFrame(i.bind(this))}},SuperParticles.prototype._process=function(){if(!this._canvas.drawing.stop){this._particlesCount=this._particles.length;for(var i=0;i<this._particlesCount;i++){for(var t=i+1;t<this._particlesCount;t++)this._particles[i].attractTo(this._particles[t]);this._particles[i].checkPosition(this._canvas.width,this._canvas.height),this._particles[i].update()}this._drawing_Redraw(),this._drawing_Diagnostic(),this._requestFrame(this._process)}},SuperParticles.prototype._drawing_Redraw=function(){if(!this._canvas.drawing.limitTo30FPS||this._diagData.frame%2==0){this._drawing_ClearCanvas();for(var i=0;i<this._particlesCount;i++){if(this._settings.linking.enabled)for(var t=Math.sqr(this._settings.linking.max_distance),e=i+1;e<this._particlesCount;e++){var s=Math.sqr(this._particles[i]._position.x-this._particles[e]._position.x)+Math.sqr(this._particles[i]._position.y-this._particles[e]._position.y);s<=t&&(this._canvas.ctx.save(),this._canvas.ctx.beginPath(),this._canvas.ctx.moveTo(this._particles[i]._position.x,this._particles[i]._position.y),this._canvas.ctx.lineTo(this._particles[e]._position.x,this._particles[e]._position.y),this._canvas.ctx.lineWidth=this._settings.linking.width,this._canvas.ctx.strokeStyle=this._settings.linking.color,this._canvas.ctx.globalAlpha=this._settings.linking.opacity*(1-s/t),this._canvas.ctx.stroke(),this._canvas.ctx.restore())}this._canvas.ctx.save(),this._particles[i].draw(this._canvas.ctx,this._settings.particles.smoothImages),this._canvas.ctx.restore()}}},SuperParticles.prototype._drawing_ClearCanvas=function(){this._canvas.ctx.save(),this._settings.background.color?(this._canvas.ctx.fillStyle=this._settings.background.color,this._canvas.ctx.globalAlpha=1,this._canvas.ctx.imageSmoothingEnabled=!1,this._canvas.ctx.fillRect(0,0,this._canvas.width,this._canvas.height)):this._canvas.ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._settings.background.image&&this._canvas.ctx.drawImage(this._settings.background.image,this._settings.background._imagePosition.x,this._settings.background._imagePosition.y,this._settings.background._imagePosition.width,this._settings.background._imagePosition.height),this._canvas.ctx.restore()},SuperParticles.prototype._drawing_Diagnostic=function(){if(this._diagData.frame++,!this._canvas.drawing.limitTo30FPS||this._diagData.frame%2==0){this._diagData.count=this._particles.length;for(var i=performance.now();0<this._diagData._times.length&&this._diagData._times[0]<=i-1e3;)this._diagData._times.shift();this._diagData._times.push(i),this._diagData.fps=(this._diagData._times.length/((i-this._diagData._times[0])/1e3)).toFixed(2),this._handleEvent("diagnostics",[{fps:this._diagData.fps,frame:this._canvas.drawing.limitTo30FPS?parseInt(this._diagData.frame/2):this._diagData.frame,count:this._diagData.count,startTime:this._diagData.startTime}])}};
//# sourceMappingURL=super-particles.min.js.map